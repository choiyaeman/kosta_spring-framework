<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.CustomerMapper">
  <insert id="insert"
          parameterType="Customer">
  	INSERT INTO customer(id, pwd, name, buildingno, addr1) 
  	VALUES (#{id},#{pwd},#{name},#{postal.buildingno},#{addr1})		
  </insert>
  
  
  <select id="selectById" 
          resultType="Customer">
SELECT 
id
,pwd
,name
,postal.buildingno "postal.buildingno"
,zipcode "postal.zipcode" 
,sido ||' ' || NVL(sigungu, ' ') ||' ' || NVL(eupmyun, ' ')  "postal.city"  
,doro || ' ' || DECODE(NVL(building2,'0'), building1, building1 ||'-' || building2) "postal.doro" 
,NVL(building, ' ') "postal.building"
,addr1
FROM   customer c LEFT OUTER JOIN postal postal ON (c.buildingno=postal.buildingno) 
WHERE id=#{id}
  </select>
 
  
  <select id="selectAll" resultType="Customer">
	SELECT 
id
,pwd
,name
,postal.buildingno "postal.buildingno"
,zipcode "postal.zipcode" 
,sido ||' ' || NVL(sigungu, ' ') ||' ' || NVL(eupmyun, ' ')  "postal.city"  
,doro || ' ' || DECODE(NVL(building2,'0'), building1, building1 ||'-' || building2) "postal.doro" 
,NVL(building, ' ') "postal.building"
,addr1
FROM   customer c LEFT OUTER JOIN postal postal ON (c.buildingno=postal.buildingno) 
ORDER BY id
	
  </select>
  
  
  <update id="update" parameterType="Customer">
  UPDATE customer
  <set>
  <if test="pwd != null || pwd != ''">
    pwd=#{pwd},	
  </if>
  <if test="name != null || name != ''">
    name=#{name},
  </if>
  <if test="postal.buildingno != null || postal.buildingno != ''">
    buildingno=#{postal.buildingno},
  </if>
  <if test="addr1 != null || addr1 != ''">
    addr1=#{addr1}
  </if>
  </set>  
  WHERE id=#{id}  
  </update>
<delete id="delete">
  DELETE FROM customer WHERE id=#{id}
  </delete>
  
</mapper>