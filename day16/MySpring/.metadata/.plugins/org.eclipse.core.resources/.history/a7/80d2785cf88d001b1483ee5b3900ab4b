<%@ page language="java" contentType="text/html; charset=UTF-8"
    pageEncoding="UTF-8"%>
<%@include file="/WEB-INF/views/variables.jsp" %><%--jstl용 변수들이 선언 : contextPath, boardPath --%>
<%@taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
<%-- <%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core" %>--%>
<%-- <c:set var="contextPath" value="${pageContext.request.contextPath }"/> --%>
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>list.jsp</title>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script> 
<script>
$(function(){
	//--게시물 클릭 시작--
	$("section>table tr>td").click(function(event){
		var board_no = $(event.target).parent().children("td.board_no").html().trim();
		$("section>form>input[name=board_no]").val(board_no);
		var $formObj = $("form");
		$formObj.attr("method", "get");
		$formObj.attr("action", "${contextPath}${boardPath}/detail");
		$formObj.submit();
		return false;
	});
	//--게시물 클릭 끝--
	
	//--검색버튼 클릭 시작--
	$("section>form>input[type=button]").click(function(){
		var $formObj = $("form");
		$formObj.attr("method", "get");
		$formObj.attr("action", "${contextPath}${boardPath}/list");
		$formObj.submit();
		return false;
	});
	//--검색버트 클릭 끝--
});
</script>
<style>
*{
  box-sizing: border-box;
}
section>table{
  border: 1px solid; border-collapse: collapse; width:50%;
}
section>table tr>td{
  border: 1px solid;
}
section>table tr>td.board_no{ width: 10%; text-align: right; }
section>table tr>td.board_title{ width: 40%; }
section>table tr>td.board_writer{ width: 20%; }
section>table tr>td.board_dt{ width: 20%; }
section>table tr>td.board_cnt{ width: 10%; text-align: right; }
</style>
</head>
<body>
<%@include file="/WEB-INF/views/header.jsp" %>
<section>
<form>
  <input type="hidden" name="board_no">
  <input type="search" name="word"><input type="button" value="검색">
</form>
<table>
<c:forEach items="${requestScope.pageGroupBean.list}" var="board">
 <tr>
   <td class="board_no">${board.board_no}</td>
   <td class="board_title">
      <c:forEach begin="2" end="${board.level}" step="1">&#10149;
      </c:forEach>${board.board_title}
   </td>
   <td class="board_writer">${board.board_writer}</td>
   <td class="board_dt">
   <fmt:formatDate value="${board.board_dt}" pattern="yyyy-MM-dd"/> </td>
   <td class="board_cnt">${board.board_cnt}</td>
 </tr>
</c:forEach>
</table>

<%--페이지목록 1,2,3... --%>
<ul style="list-style-type: none; padding: 0px">
<c:if test="${requestScope.pageGroupBean.startPage > 1}">
  <li style="display: inline-block;"><span class="${requestScope.pageGroupBean.startPage-1}">&#9754;</span>&nbsp;&nbsp;&nbsp;</li> <%--prev --%>
</c:if>
<c:forEach begin="${requestScope.pageGroupBean.startPage}" 
           end="${requestScope.pageGroupBean.endPage}" 
           step="1" 
           var="i">
  <li style="display: inline-block;">
    <c:choose>
    <c:when test="${i == requestScope.pageGroupBean.currentPage}"> <%--페이지목록값이 현재페이지인 경우 --%>
       <span class="${i}" style="font-weight: bold;color: red;">
       ${i}
       </span>
    </c:when>
    <c:otherwise>
    <span class="${i}">${i}</span>
    </c:otherwise>
    </c:choose>
    &nbsp;&nbsp;&nbsp;
  </li>
</c:forEach>
<c:if test="${requestScope.pageGroupBean.endPage < requestScope.pageGroupBean.totalPage }">
  <li style="display: inline-block;"><span class="${requestScope.pageGroupBean.endPage+1}">&#9654;</span></li><%--next --%>
</c:if>
</ul>
</section>
<%@include file="/WEB-INF/views/footer.jsp" %>
<script>
$("ul>li>span").click(function(event){
	var classValue = $(event.target).attr("class");
	location.href="/mvcspring/board/list?currentPage="+ classValue;
});
</script>
</body>
</html>