<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  <mapper namespace="mybatis.OrderMapper">
  	<resultMap id="orderMap" type="com.my.vo.OrderInfo">
  		<id property="order_no" column="order_no"/>
  		<result property="order_dt" column="order_dt"/>
  		<collection property="lines" ofType="com.my.vo.OrderLine">
  			<id property="order_no" column="order_no"/>
  			<result property="order_quantity" column="order_quantity"/>
  			<association property="p" javaType="com.my.vo.Product">
  			</association>
  		</collection>
  	</resultMap>
  	<select id="" resultMap="orderMap" parameterType="string">
	SELECT info.order_no, info.order_dt,
           line.order_prod_no, line.order_quantity,
           p.prod_name, p.prod_price
	FROM order_info info JOIN order_line line ON (info.order_no = line.order_no)
                         JOIN product p ON (line.order_prod_no = p.prod_no)
	WHERE info.order_id=#{order_id}
  	</select>
  </mapper>